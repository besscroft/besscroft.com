---
title: "æƒé™æ¨¡åž‹ä¹‹åŸºäºŽè§’è‰²çš„è®¿é—®æŽ§åˆ¶ï¼ˆRBACï¼‰"
date: 2022-03-30T15:54:51+08:00
categories: ["æŠ€æœ¯"]
tags: ["æƒé™æ¨¡åž‹","RBAC","Kubernetes ä¸­çš„ RBAC","åŸºäºŽè§’è‰²çš„è®¿é—®æŽ§åˆ¶"]
---

## å‰è¨€

åœ¨æžæ˜Žç™½ RBAC è¿™ä¸ªè®¿é—®æŽ§åˆ¶æ¨¡åž‹ä¹‹å‰ï¼Œæˆ‘ä»¬å¾—å…ˆäº†è§£ä¸‹ï¼Œä¿¡æ¯å®‰å…¨ä¸­çš„ä¸€äº›åŸºæœ¬çš„æ¦‚å¿µï¼Œä»Žè€Œäº†è§£ RBAC å±žäºŽå“ªä¸€ä¸ªçŽ¯èŠ‚ã€‚

- è®¤è¯ï¼ˆAuthenticationï¼‰ï¼šç³»ç»Ÿè¯†åˆ«æ“ä½œç”¨æˆ·çš„çœŸå®žèº«ä»½ï¼Œä¹Ÿå°±æ˜¯å¼„æ¸…æ¥šæ“ä½œç”¨æˆ·åˆ°åº•æ˜¯è°ã€‚
- æŽˆæƒï¼ˆ Authorizationï¼‰ï¼šç³»ç»ŸæŽ§åˆ¶ä¸€ä¸ªç”¨æˆ·æ“ä½œæ•°æ®çš„æƒé™ï¼Œä¹Ÿå°±æ˜¯æŽ§åˆ¶æ“ä½œç”¨æˆ·åœ¨ç³»ç»Ÿä¸­èƒ½å¹²ä»€ä¹ˆã€‚
- å‡­è¯ï¼ˆCredentialï¼‰ï¼šç³»ç»Ÿæ‰¿è½½å’Œç”¨æˆ·çš„è®¤è¯æŽˆæƒä¿¡æ¯ï¼Œä½ éœ€è¦ä¸€ä¸ªå‡­è¯ï¼Œæ¥è¯æ˜Žä½ å°±æ˜¯ä½ ï¼Œç„¶åŽå°±å¯ä»¥å¹²å…è®¸ä½ å¹²çš„äº‹äº†ã€‚
- æœºå¯†ï¼ˆConfidentialityï¼‰ï¼šç³»ç»Ÿç¡®ä¿å‡­è¯æˆ–æ•°æ®ä¼ é€’ä¸Žå­˜å‚¨çš„éšç§˜æ€§ï¼Œé¿å…è¢«ç¯¡æ”¹æˆ–è€…æ³„éœ²ã€‚
- ä¼ è¾“ï¼ˆTransport Securityï¼‰ï¼šç¡®ä¿ç³»ç»Ÿå’Œç”¨æˆ·ä¹‹é—´çš„ç½‘ç»œä¼ è¾“ä¿¡æ¯æ— æ³•è¢«ç¬¬ä¸‰æ–¹çªƒå¬ã€ç¯¡æ”¹ã€‚
- éªŒè¯ï¼ˆVerificationï¼‰ï¼šç³»ç»Ÿç¡®ä¿æäº¤åˆ°æ¯é¡¹æœåŠ¡ä¸­çš„æ•°æ®æ˜¯åˆä¹Žè§„åˆ™çš„ï¼Œä¹±å¡«ä¸€äº›æ•°æ®ï¼Œæ˜¯å¯èƒ½å¯¼è‡´ç³»ç»Ÿå®‰å…¨é—®é¢˜çš„ã€‚

é‚£ä¹ˆ RBAC æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„å‘¢ï¼Ÿä¹Ÿå°±æ˜¯â€œ**è°**ï¼ˆUserï¼‰æ‹¥æœ‰ä»€ä¹ˆ**æƒé™**ï¼ˆAuthorityï¼‰åŽ»**æ“ä½œ**ï¼ˆOperationï¼‰å“ªäº›**èµ„æº**ï¼ˆResourceï¼‰â€ï¼Œæ‰€ä»¥æœ¬è´¨ä¸Šå±žäºŽä¸€ç§æŽˆæƒï¼ˆè®¿é—®æŽ§åˆ¶ï¼‰è¡Œä¸ºã€‚

## RBAC

### ä»€ä¹ˆæ˜¯ RBACï¼Ÿ

åŸºäºŽè§’è‰²çš„è®¿é—®æŽ§åˆ¶ï¼ˆRole-based access controlï¼Œç®€ç§° RBACï¼‰ï¼ŒæŒ‡çš„æ˜¯é€šè¿‡ç”¨æˆ·çš„è§’è‰²ï¼ˆRoleï¼‰æŽˆæƒå…¶ç›¸å…³æƒé™ï¼Œè¿™å®žçŽ°äº†æ›´çµæ´»çš„è®¿é—®æŽ§åˆ¶ï¼Œç›¸æ¯”ç›´æŽ¥æŽˆäºˆç”¨æˆ·æƒé™ï¼Œè¦æ›´åŠ ç®€å•ã€é«˜æ•ˆã€å¯æ‰©å±•ã€‚

![](/images/articles/2022/just-rbac-it/rbac01.png)

### æ€Žä¹ˆç†è§£ RBACï¼Ÿ

![](/images/articles/2022/just-rbac-it/rbac02.png)

è¿™é‡Œæˆ‘ç”»äº†ä¸€å¼ å›¾ï¼Œå›¾ä¸­çš„è´ä¸æ˜¯ç®¡ç†å‘˜ï¼Œæ‰€ä»¥ä»–å…·å¤‡äº†å¯¹èµ„æº A å’Œèµ„æº B çš„å¯è¯»ã€å¯å†™èµ„æºã€‚è€ŒèŽ«æ–¯ä½œä¸ºå¼€å‘è€…ï¼Œä»–å¯¹èµ„æº A å…·æœ‰å¯è¯»ã€å¯å†™æƒé™ï¼Œä½†æ˜¯å¯¹èµ„æº B åªæœ‰å¯è¯»æƒé™ã€‚è¿™æ ·æˆ‘ä»¬å°±æ»¡è¶³äº†â€œ**è°**ï¼ˆUserï¼‰æ‹¥æœ‰ä»€ä¹ˆ**æƒé™**ï¼ˆAuthorityï¼‰åŽ»**æ“ä½œ**ï¼ˆOperationï¼‰å“ªäº›**èµ„æº**ï¼ˆResourceï¼‰â€çš„è¡Œä¸ºã€‚ä½†æ˜¯æ˜¾ç„¶æœ‰ä¸ªä¸å¥½çš„åœ°æ–¹ï¼Œè®©æˆ‘ä»¬æŽ¥ç€å¾€ä¸‹è¯´ã€‚

![](/images/articles/2022/just-rbac-it/rbac03.png)

è¿™æ—¶æ¥äº†ä¸€ä¸ªæ–°çš„å¼€å‘äººå‘˜å¡”æ–¯ï¼Œæƒ³åŠ å…¥æˆ‘ä»¬ä¸€èµ·å¼€å‘ï¼Œç”±äºŽä»–çš„èŒè´£å’ŒèŽ«æ–¯æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»™ä»–åˆ†é…äº†åŒæ ·çš„æƒé™ã€‚ç»†å¿ƒçš„ä½ å¯èƒ½å·²ç»å‘çŽ°äº†ï¼Œç»™èŽ«æ–¯å’Œå¡”æ–¯åˆ†é…æƒé™æ˜¯ä¸€ä¸ªé‡å¤çš„æ­¥éª¤ï¼Œçœ‹ä¸ŠåŽ»å¹¶æ²¡æœ‰ä»€ä¹ˆä¸å¦¥ã€‚

é‚£ä¹ˆæˆ‘ä»¬è¦æƒ³è±¡ä¸€ç§ç³Ÿç³•çš„åœºæ™¯ï¼Œå¦‚æžœæˆ‘ä»¬éœ€è¦å¯¹å¼€å‘äººå‘˜åˆ†é…è®¸å¤šçš„æƒé™ï¼Œè€Œä¸”å¼€å‘äººå‘˜åŒæ—¶åˆæœ‰å¾ˆå¤šè¯¥æ€Žä¹ˆåŠžï¼Ÿæƒ³å¿…è´ä¸ç®¡ç†å‘˜è¿™æ—¶ä¸€å®šåœ¨æŠ±æ€¨äº†ï¼ðŸ¥²å¦‚æžœæˆ‘ä»¬è¿™æ—¶è¦åˆ é™¤æ‰€æœ‰å¼€å‘äººå‘˜å¯¹èµ„æº A çš„å¯å†™æƒé™ï¼Œä¹Ÿéœ€è¦ä¸€ä¸ªä¸ªæ›´æ”¹ï¼Œè¿™ç®€ç›´åé€äº†ðŸ¤¬

![](/images/articles/2022/just-rbac-it/rbac04.png)

è¿™æ—¶æˆ‘ä»¬å¯ä»¥è€ƒè™‘ç”¨ä¸€ç§é€šç”¨é…ç½®çš„æ€è·¯ï¼Œè€Œä¸æ˜¯ç›´æŽ¥ç»™ç”¨æˆ·åˆ†é…è¿™äº›æƒé™ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬åªéœ€è¦ç»™è´ä¸åˆ†é… `admin` é…ç½®ï¼Œç»™èŽ«æ–¯å’Œå¡”æ–¯åˆ†é… `dev` é…ç½®å³å¯ã€‚å¦‚æžœä¸‹æ¬¡å†æœ‰å°ä¼™ä¼´è¦å‚ä¸Žè¿›æ¥ï¼Œç›´æŽ¥åˆ†é…ç»™ä»– `dev` é…ç½®å°±å¯ä»¥äº†ã€‚

![](/images/articles/2022/just-rbac-it/rbac05.png)

æˆ‘ä»¬åœ¨ç³»ç»Ÿä¸­é€šå¸¸æŠŠè¿™äº›é…ç½®æ–‡ä»¶å«åšâ€œè§’è‰²â€ï¼Œè¿™ä¹Ÿå°±æ˜¯åŸºäºŽè§’è‰²çš„è®¿é—®æŽ§åˆ¶çš„æ–¹å¼ï¼Œè¿˜æ˜¯å¾ˆå¥½ç†è§£çš„ï¼Œå¯¹å§ï¼Ÿ

### è½¯ä»¶å¼€å‘ä¸­çš„ RBAC

![](/images/articles/2022/just-rbac-it/rbac06.png)

åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œæ™®éé‡‡ç”¨çš„ RBAC æ¨¡åž‹ï¼Œæ˜¯ `NIST RBAC` æ¨¡åž‹ã€‚å’±ä»¬ä¸Šé¢è¯´çš„ï¼Œä¸ºäº†é¿å…å¯¹æ¯ä¸€ä¸ªç”¨æˆ·å•ç‹¬è®¾ç½®æƒé™ï¼Œä»¥åŠé¿å…è¿‡ç¨‹ä¸­å®¹æ˜“äº§ç”Ÿçš„é”™è¯¯ï¼Œå°†æƒé™ä»Žç›´æŽ¥ç»‘å®šç”¨æˆ·ï¼Œæ”¹ä¸ºäº†ç»‘å®šâ€œè§’è‰²â€ã€‚å°†æƒé™æŽ§åˆ¶å˜ä¸ºäº†å¯¹â€œ**è§’è‰²**æ‹¥æœ‰æ“ä½œå“ªäº›**èµ„æº**çš„**è®¸å¯**â€ã€‚

è¿™é‡Œçš„â€œè®¸å¯â€å¯ä»¥ç†è§£ä¸ºæŠ½è±¡æƒé™çš„å…·è±¡åŒ–ä½“çŽ°ï¼Œè§’è‰²è§£è€¦äº†ç”¨æˆ·å’Œæƒé™ä¹‹é—´çš„å¤šå¯¹å¤šå…³ç³»ï¼Œè€Œè®¸å¯æ˜¯ç”¨æ¥è§£è€¦æ“ä½œå’Œèµ„æºä¹‹é—´çš„å¤šå¯¹å¤šå…³ç³»çš„ã€‚æ¯”å¦‚å¯¹èµ„æº A å¯ä»¥æœ‰å¢žã€åˆ ã€æ”¹ã€æŸ¥ç­‰æ“ä½œã€‚

> æ³¨ï¼š1996å¹´ï¼ŒèŽ±å¨Â·æ¡‘åº¦ï¼ˆRavi Sandhuï¼‰ç­‰äººåœ¨å‰äººçš„ç†è®ºåŸºç¡€ä¸Šï¼Œæå‡ºä»¥è§’è‰²ä¸ºåŸºç¡€çš„è®¿é—®æŽ§åˆ¶æ¨¡åž‹ï¼Œæ•…è¯¥æ¨¡åž‹åˆè¢«ç§°ä¸ºRBAC96ã€‚ä¹‹åŽï¼Œç¾Žå›½å›½å®¶æ ‡å‡†å±€é‡æ–°å®šä¹‰äº†ä»¥è§’è‰²ä¸ºåŸºç¡€çš„è®¿é—®æŽ§åˆ¶æ¨¡åž‹ï¼Œå¹¶å°†ä¹‹çº³ä¸ºä¸€ç§æ ‡å‡†ï¼Œç§°ä¹‹ä¸ºNIST RBACã€‚

åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œå¦‚æžœè¦å®žçŽ° RBAC æ¨¡åž‹ï¼Œåˆ™éœ€è¦å®žçŽ°å®ƒçš„å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼š

- ç”¨æˆ·ï¼šè®¿é—®ç³»ç»Ÿçš„ä»»æ„ç”¨æˆ·ã€‚
- è§’è‰²ï¼šè§’è‰²æ˜¯ä¸€ä¸ªé€»è¾‘é›†åˆï¼Œä½ å¯ä»¥æŽˆæƒä¸€ä¸ªè§’è‰²æŸäº›æ“ä½œæƒé™ï¼Œç„¶åŽå°†è§’è‰²æŽˆäºˆç»™ç”¨æˆ·ï¼Œè¢«æŽˆäºˆè§’è‰²çš„ç”¨æˆ·å°†ä¼šç»§æ‰¿è¿™ä¸ªè§’è‰²ä¸­çš„**æ‰€æœ‰**æƒé™ã€‚
- èµ„æºï¼šåº”ç”¨ç³»ç»Ÿä¸­çš„å®žä½“å¯¹è±¡ä¸€èˆ¬å®šä¹‰ä¸ºèµ„æºï¼Œæ¯”å¦‚è®¢å•ã€å•†å“ã€æ–‡æ¡£ç­‰ç­‰ï¼Œè€Œæ¯ç§èµ„æºéƒ½å¯ä»¥å®šä¹‰å¤šä¸ªæ“ä½œï¼Œæ¯”å¦‚å•†å“æœ‰æŸ¥çœ‹ã€ç¼–è¾‘ã€ä¸Šæž¶ã€åˆ é™¤æ“ä½œï¼›
- æŽˆæƒï¼šæŠŠæŸç±»ï¼ˆä¸ªï¼‰èµ„æºçš„æŸäº›ï¼ˆä¸ªï¼‰æ“ä½œæŽˆæƒç»™è§’è‰²**æˆ–è€…**ç”¨æˆ·ã€‚

![](/images/articles/2022/just-rbac-it/rbac07.png)

æ³¨æ„â€œæŽˆæƒâ€è¿™ä¸€é¡¹ï¼Œæˆ‘ç»™â€œæˆ–è€…â€åŠ ç²—äº†ï¼Œä¸ºä»€ä¹ˆè¿™é‡Œç”¨â€œæˆ–è€…â€å‘¢ã€‚å› ä¸ºæœ‰äº›è½¯ä»¶å¼€å‘æ¡†æž¶åœ¨è®¾è®¡æ—¶ï¼Œå¹¶æ²¡æœ‰å®Œå…¨éµå¾ª RBAC æ¥è®¾è®¡ï¼Œæ¯”å¦‚ [Spring Security](https://spring.io/projects/spring-security)...ä¸è¿‡å¹¶ä¸æ˜¯è¯´è¿™æ ·è®¾è®¡ä¸å¥½ï¼Œé¦–å…ˆæ€Žä¹ˆç”¨æ˜¯ç”¨æˆ·è‡ªå·±çš„äº‹ï¼Œå¯ä»¥å®Œå…¨éµå®ˆ RBAC æ¥ç”¨ï¼Œè€Œ Authority åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œå®ƒä¹Ÿæ˜¯é€‚ç”¨çš„ã€‚

### æ“ä½œç³»ç»Ÿä¸­çš„ RBAC

åœ¨ Linux/Unix ç³»ç»Ÿä¸­ï¼ŒRBAC ç”¨äºŽæŽ§åˆ¶ç”¨æˆ·å¯¹é€šå¸¸ä»…é™äºŽè¶…çº§ç”¨æˆ·çš„ä»»åŠ¡çš„è®¿é—®ã€‚é€šè¿‡å¯¹è¿›ç¨‹å’Œç”¨æˆ·åº”ç”¨å®‰å…¨å±žæ€§ï¼ŒRBAC å¯ä»¥å‘å¤šä¸ªç®¡ç†å‘˜åˆ†æ´¾è¶…çº§ç”¨æˆ·åŠŸèƒ½ã€‚è¿›ç¨‹æƒé™ç®¡ç†é€šè¿‡ç‰¹æƒå®žçŽ°ã€‚ç”¨æˆ·æƒé™ç®¡ç†é€šè¿‡ RBAC å®žçŽ°ã€‚

æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œroot ç”¨æˆ·åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œæ˜¯å…·æœ‰æœ€é«˜æƒé™çš„ï¼Œæ˜¯åŸºäºŽå«åšè¶…çº§ç”¨æˆ·æ¨¡åž‹çš„ï¼ˆç®¡ç†å‘˜å¯¹ç³»ç»Ÿè¦ä¹ˆå…·æœ‰å…¨éƒ¨æŽ§åˆ¶æƒè¦ä¹ˆæ¯«æ— æŽ§åˆ¶æƒï¼‰ã€‚è€Œä½¿ç”¨ RBACï¼Œå¯ä»¥åœ¨æ›´ç²¾ç»†çš„çº§åˆ«ä¸Šå¼ºåˆ¶æ‰§è¡Œå®‰å…¨ç­–ç•¥ã€‚RBAC é‡‡ç”¨æœ€å°ç‰¹æƒçš„å®‰å…¨åŽŸåˆ™ã€‚æœ€å°ç‰¹æƒè¡¨ç¤ºç”¨æˆ·ä»…å…·æœ‰æ‰§è¡ŒæŸé¡¹ä½œä¸šæ‰€å¿…éœ€çš„ç‰¹æƒã€‚æ™®é€šç”¨æˆ·å…·æœ‰è¶³å¤Ÿç‰¹æƒæ¥ä½¿ç”¨å…¶åº”ç”¨ç¨‹åºã€æ£€æŸ¥å…¶ä½œä¸šçŠ¶æ€ã€æ‰“å°æ–‡ä»¶ã€åˆ›å»ºæ–°æ–‡ä»¶ç­‰ã€‚è¶…å‡ºæ™®é€šç”¨æˆ·åŠŸèƒ½ä»¥å¤–çš„åŠŸèƒ½å°†åˆ†ç»„åˆ°å„æƒé™é…ç½®æ–‡ä»¶ä¸­ã€‚å¦‚æžœç”¨æˆ·å°†è¦æ‰§è¡Œçš„ä½œä¸šè¦æ±‚å…·æœ‰æŸäº›è¶…çº§ç”¨æˆ·åŠŸèƒ½æ‰èƒ½æ‰§è¡Œï¼Œè¿™äº›ç”¨æˆ·å°†æ‰¿æ‹…æ‹¥æœ‰é€‚å½“æƒé™é…ç½®æ–‡ä»¶çš„è§’è‰²ã€‚

RBAC ä¼šå°†è¶…çº§ç”¨æˆ·åŠŸèƒ½æ”¶é›†åˆ°æƒé™é…ç½®æ–‡ä»¶ä¸­ã€‚è¿™äº›æƒé™é…ç½®æ–‡ä»¶å°†æŒ‡å®šç»™ç§°ä¸ºè§’è‰²çš„ç‰¹æ®Šç”¨æˆ·å¸æˆ·ã€‚ç„¶åŽï¼Œç”¨æˆ·å¯ä»¥æ‰¿æ‹…æŸä¸ªè§’è‰²ï¼Œä»¥æ‰§è¡Œè¦æ±‚å…·æœ‰æŸäº›è¶…çº§ç”¨æˆ·åŠŸèƒ½æ‰èƒ½æ‰§è¡Œçš„ä½œä¸šã€‚

> å‚è€ƒèµ„æ–™ï¼š
> [RedHat åŸºäºŽè§’è‰²çš„è®¿é—®æŽ§åˆ¶ (RBAC)](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/5/html/deployment_guide/selg-overview#sec-rbac-intro1)

### Kubernetes ä¸­çš„ RBAC

åœ¨ Kubernetes ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸æŽˆäºˆå¯¹ API ç«¯ç‚¹ï¼ˆendpointsï¼‰çš„è®¿é—®æƒé™ã€‚RBAC é€šè¿‡å…è®¸æˆ–ç¦æ­¢è®¿é—®ç®¡ç† API èµ„æºæ¥å®šä¹‰ç”¨æˆ·ã€ç»„å’Œè¿›ç¨‹çš„ç­–ç•¥ã€‚

åœ¨ Kubernetes ä¸­ï¼Œå¯ä»¥ç”¨ RBAC åšå“ªäº›æ“ä½œå‘¢ï¼Ÿæ¯”å¦‚ï¼š

- ä¸ºç³»ç»Ÿçš„ä¸åŒç”¨æˆ·ï¼Œå®šä¹‰ä¸åŒçš„è§’è‰²ï¼Œæ¥è®¿é—®ä¸åŒçš„ Kubernetes èµ„æºã€‚
- æŽ§åˆ¶ Pod ä¸­è¿è¡Œçš„è¿›ç¨‹ï¼Œä»¥åŠå¯ä»¥é€šè¿‡ Kubernetes API æ‰§è¡Œçš„æ“ä½œã€‚
- é™åˆ¶å‘½åç©ºé—´çš„èµ„æºå¯è§æ€§ç­‰ç­‰ã€‚

![](/images/articles/2022/just-rbac-it/rbac08.png)

åœ¨ Kubernetes ä¸­ï¼ŒRBAC ç”±ä¸‰ä¸ªæ¨¡å—ç»„æˆï¼Œå®ƒä»¬ä¸€èµ·å°† API åŽŸè¯­ï¼ˆAPI primitivesï¼‰åŠå…¶å…è®¸çš„æ“ä½œè¿žæŽ¥åˆ°ç”¨æˆ·ã€ç»„æˆ–è€… [ServiceAccount](https://kubernetes.io/zh/docs/tasks/configure-pod-container/configure-service-account/). 

#### Kubernetes RBAC API

æˆ‘ä»¬æ¥äº†è§£ä¸‹å®žçŽ° RBAC åŠŸèƒ½çš„ Kubernetes API åŽŸè¯­ï¼š

- è§’è‰²ï¼šè§’è‰² API åŽŸè¯­å£°æ˜Žäº†è¯¥è§„åˆ™å¯ä»¥æ“ä½œçš„ API èµ„æºåŠå…¶æ“ä½œï¼ˆæŸ¥çœ‹ã€åˆ é™¤ç­‰ï¼‰ã€‚
	- å…è®¸æŸ¥çœ‹å’Œåˆ é™¤ Pods
	- å…è®¸æŸ¥çœ‹ Pods çš„æ—¥å¿—
- RoleBindingï¼šRoleBinding API åŽŸè¯­å°†è§’è‰²ç»‘å®šåˆ°ä¸»é¢˜ã€‚ä¾‹å¦‚ï¼šå°†å…è®¸æ›´æ–°æœåŠ¡çš„è§’è‰²ç»‘å®šåˆ°ç”¨æˆ· è´ä¸ã€‚

![](/images/articles/2022/just-rbac-it/rbac09.png)

æ‰€æœ‰çš„ Kubernetes é›†ç¾¤éƒ½æœ‰ä¸¤ç±»ç”¨æˆ·ï¼šKubernetes ç®¡ç†çš„ Service Account å’Œæ™®é€šç”¨æˆ·ã€‚è§’è‰²å¯ä»¥åˆ†é…ç»™å¤–éƒ¨ç”¨æˆ·æˆ–æœºå™¨äººï¼ˆé›†ç¾¤å†…çš„åº”ç”¨ç¨‹åºï¼‰ã€‚æˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹ï¼Œå®Œæˆè®¿é—®æŽ§åˆ¶çš„è¡Œä¸ºï¼Œéœ€è¦çš„å‡ æ­¥æ“ä½œï¼š

- åˆ›å»º/æ‹¥æœ‰ä¸€ä¸ªç”¨æˆ·ã€‚
- åˆ›å»ºè§’è‰²ä»¥å‘ API ç«¯ç‚¹æŽˆäºˆæƒé™ã€‚
- å°†è§’è‰²é“¾æŽ¥åˆ°ç”¨æˆ·ã€‚

æœ€åŽä¸€æ­¥ç§°ä¸ºç»‘å®šï¼Œç”±ä¸Šå›¾ä¸­åä¸º RoleBinding çš„å¯¹è±¡å®Œæˆï¼Œè¯¥å¯¹è±¡å°†èº«ä»½é“¾æŽ¥åˆ°è§’è‰²ã€‚

> æ³¨ï¼šRoles å’Œ RoleBindings åœ¨å‘½åç©ºé—´ä¸­åˆ›å»ºï¼Œå®ƒä»¬æŽˆäºˆå¯¹å½“å‰å‘½åç©ºé—´ä¸­èµ„æºçš„è®¿é—®æƒé™ã€‚å¦‚æžœéœ€è¦å°†è§’è‰²å®šä¹‰ä¸ºå…¨å±€è€Œä¸æ˜¯é™å®šä¸ºå‘½åç©ºé—´ï¼Œéœ€è¦ [ClusterRole](https://kubernetes.io/zh/docs/reference/kubernetes-api/authorization-resources/cluster-role-v1/)ï¼Œè¦å°†èº«ä»½é“¾æŽ¥åˆ°å…¨å±€è§’è‰²ï¼Œéœ€è¦ä½¿ç”¨ [ClusterRoleBinding](https://kubernetes.io/zh/docs/reference/kubernetes-api/authorization-resources/cluster-role-binding-v1/)ã€‚

## æœ€åŽ

RBAC è®¿é—®æŽ§åˆ¶æ¨¡åž‹ï¼Œåº”è¯¥æ˜¯å¼€å‘ä¸­æ¯”è¾ƒå¸¸è§çš„æ¨¡åž‹äº†ï¼Œæˆ‘é‡‡å–å›¾æ–‡çš„å½¢å¼ï¼Œç»“åˆè‡ªå·±çš„ç†è§£ï¼Œå†™ä¸‹äº†è¿™ç¯‡æ–‡å­—ï¼Œå¸Œæœ›èƒ½å¯¹çœ‹åˆ°çš„å°ä¼™ä¼´æä¾›å¸®åŠ©ï¼ðŸ˜Š

> æˆ‘çš„æ°´å¹³å’Œè®¤çŸ¥éƒ½æ˜¯æœ‰é™çš„ï¼Œå¦‚æžœä½ æƒ³äº†è§£æ›´å¤šå…³äºŽ RBAC æˆ–è€…è®¿é—®æŽ§åˆ¶æ¨¡åž‹çš„çŸ¥è¯†ï¼Œæˆ‘ä¸ºä½ å‡†å¤‡äº†ä¸€äº›å‚è€ƒèµ„æ–™é“¾æŽ¥ï¼š
> [AWS çš„è®¿é—®æŽ§åˆ¶æ¨¡åž‹](https://docs.aws.amazon.com/IAM/latest/UserGuide/access.html)
> [Wiki-åŸºäºŽè§’è‰²çš„è®¿é—®æŽ§åˆ¶](https://zh.wikipedia.org/zh-cn/%E4%BB%A5%E8%A7%92%E8%89%B2%E7%82%BA%E5%9F%BA%E7%A4%8E%E7%9A%84%E5%AD%98%E5%8F%96%E6%8E%A7%E5%88%B6)
> [Kubernetes ä½¿ç”¨ RBAC é‰´æƒ](https://kubernetes.io/zh/docs/reference/access-authn-authz/rbac/)
> [åŸºäºŽè§’è‰²çš„è®¿é—®æƒé™æŽ§åˆ¶ (RBAC) æ¦‚è§ˆ ](https://cloud.google.com/data-fusion/docs/concepts/rbac?hl=zh_cn)
> [Azure çš„è®¿é—®æŽ§åˆ¶æ¨¡åž‹](https://docs.microsoft.com/en-us/azure/role-based-access-control/overview)